
<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../elements/icon-detail-value-chip.html">
<link rel="import" href="../../elements/tablet-graphic.html">
<link rel="import" href="../../redux/redux-mixin.html">

<dom-module id="tablet-details-section">
  <template>
    <style>
      :host {
        display: grid;
        grid-template-columns: repeat(3, auto);
        grid-template-rows: repeat(4, auto);
        padding: 36px 64px 72px 64px;
        grid-gap: 24px 32px
      }
      .title {
        grid-row: 1 / 2;
        grid-column: 1 / 4;
        @apply --paper-font-title;
      }
      icon-detail-value-chip {
        padding-left: 16px;
      }
      
      #schematic-layout {
        grid-row: 4 / 5;
        grid-column: 1 / 4;
        align-self: center;
        justify-self: center;
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr auto;
        grid-gap: 0px 32px;
        align-items: center;
        justify-items: center;
        border-radius: 16px;
        background-color: var(--gray-color);
        border: 5px solid var(--border-color);
        padding: 8px 16px 16px 16px;
        /*max-width: 450px;*/
        margin: 24px auto;
      }
      tablet-graphic {
        width: 175px;
        height: 175px;
      }
      .schematic-label {
        @apply --paper-font-subhead;
        text-align: center;
      }
    </style>
    
    <div class='title'>Tablet Properties</div>
    <icon-detail-value-chip icon='my-icons:ruler' value='[[_getDimensionString(shape, length, width, thickness)]]' label='Dimensions'></icon-detail-value-chip>
    <icon-detail-value-chip icon='my-icons:surface-area' value='[[_getSurfaceAreaString(surfaceArea)]]' label='Surface Area'></icon-detail-value-chip>
    <icon-detail-value-chip icon='my-icons:density' value='[[_getDensityString(compressedDensity)]]' label='Compressed Density'></icon-detail-value-chip>
    <icon-detail-value-chip icon='my-icons:weight' value='[[_getWeightString(weight)]]' label='Tablet Weight'></icon-detail-value-chip>
    <icon-detail-value-chip icon='my-icons:volume' value='[[_getVolumeString(volume)]]' label='Volume'></icon-detail-value-chip>
    <icon-detail-value-chip icon='my-icons:density' value='[[_getDensityString(bulkDensity)]]' label='Bulk Density'></icon-detail-value-chip>
    <div id='schematic-layout'>
      <tablet-graphic top-view shape='round' length='0.011' band-thickness='0.0042' cup-thickness='0.001'></tablet-graphic>
      <tablet-graphic length-view length='0.011' band-thickness='0.0042' cup-thickness='0.001'></tablet-graphic>
      <div class='schematic-label'>Top View</div>
      <div class='schematic-label'>Side View</div>
    </div>

  </template>

  <script>
    class TabletDetailsSection extends ReduxMixin(Polymer.Element) {
      static get is() { return 'tablet-details-section'; }
      static get properties() {
        return {
          shape: {type: String, statePath: "tablet.shape"},
          length: {type: Number, statePath: "tablet.length"},
          width: {type: Number, statePath: "tablet.width"},
          thickness: {type: Number, statePath: "tablet.totalThickness"},
          weight: {type: Number, statePath: "tablet.weight"},
          bulkDensity: {type: Number, statePath: "tablet.bulkDensity"},
          compressedDensity: {type: Number, statePath: "tablet.compressedDensity"},
          surfaceArea: {type: Number, statePath: "tablet.totalArea"},
          volume: {type: Number, statePath: "tablet.totalVolume"}
        };
      }
      
      _getDimensionString(shape, length, width, thickness) {
        // values in meters and need to convert to mm.
        let conv = 1000;
        if(shape === 'round') {
          return `${(length * conv).toFixed(1)} mm x ${(thickness * conv).toFixed(1)} mm`;
        } else {
          return `${(length * conv).toFixed(1)} mm x ${(width * conv).toFixed(1)} mm x ${(thickness * conv).toFixed(1)} mm`;
        }
      }
      
      _getDensityString(density) {
        return `${ (density * 1e-6).toFixed(2) } g/ml`;
      }
      
      _getWeightString(weight) {
        return `${ (weight * 1000).toFixed(1) } mg`;
      }
      
      _getVolumeString(volume) {
        return `${ (volume * 1000000).toFixed(2) } ml`;
      }
      
      _getSurfaceAreaString(surfaceArea) {
        return `${ (surfaceArea * 10000).toFixed(2) } cm2`;
      }
    }

    window.customElements.define(TabletDetailsSection.is, TabletDetailsSection);
  </script>
</dom-module>
