
<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../elements/cards/tagged-toolbar-card.html">
<link rel="import" href="../../elements/graphics/tablet-graphic.html">
<link rel="import" href="../../elements/list-items/small-icon-item.html">
<link rel="import" href="../../elements/my-icons.html">
<link rel="import" href="../../redux/redux-mixin.html">
<!--<link rel="import" href="tablet-library.html">-->
<!--<link rel="import" href="tablet-editor.html">-->

<dom-module id="tablet-card">
  
   <template>
    
    <style>
      :host {
        display: flex;
      }
    </style>
        
      
    <tagged-toolbar-card title='Substrate'>
      <p slot='description'>
        The tablet shape, size and formulation effect the coating process
        in many ways. Including the film thickness, coating uniformity and optimal batch size.
      </p>
      <div slot='item-title'>[[tablet.productName]]</div>
      <small-icon-item slot='item' label='[[_getTabletWeightString(tablet.weight)]]' icon='my-icons:weight'></small-icon-item>
      <small-icon-item slot='item' label='[[_getTabletDimensionString(tablet.shape, tablet.length, tablet.width)]]' icon='my-icons:ruler'></small-icon-item>
      <tablet-graphic slot='graphic' top-view tablet='[[tablet]]'></tablet-graphic>
      <tablet-graphic slot='graphic' length-view tablet='[[tablet]]'></tablet-graphic>
      <paper-icon-button on-click='_openLibrary' icon='my-icons:library' slot='toolbar'></paper-icon-button>
      <paper-icon-button on-click='_openEditor' icon='my-icons:edit' slot='toolbar'></paper-icon-button>
    </tagged-toolbar-card>  

    <!--<tablet-library id='library'></tablet-library>-->
    
    <!--<tablet-editor id='editor'></tablet-editor>-->
    
  </template>

  <script>
    class TabletCard extends ReduxMixin(Polymer.Element) {
      static get is() { return 'tablet-card'; }
      static get properties() {
        return {
          tablet: { type: Object, statePath: 'tablet' }
        };
      }
      
       _getTabletDimensionString(shape, length, width) {
        // values in meters and need to convert to mm.
        let conv = 1000;
        if(shape === 'round') {
          return `${(length * conv).toFixed(1)} mm`;
        } else {
          return `${(length * conv).toFixed(1)} x ${(width * conv).toFixed(1)} mm`;
        }
      }
      
      _getTabletWeightString(weight) {
        return `${(weight * 1000).toFixed(1)} mg`;
      }
      _openLibrary() {
        window.location = '#/tablet-library';
      }
      _openEditor() {
        window.location = '#/tablet-editor';
      }
      
    }

    window.customElements.define(TabletCard.is, TabletCard);
  </script>
</dom-module>
