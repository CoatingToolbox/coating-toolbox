
<script src="../../node_modules/redux/dist/redux.js"></script>

<link rel="import" href="../../bower_components/polymer-redux/polymer-redux.html">
<link rel="import" href="../data/coating-pan-class.html">
<link rel="import" href="../data/coating-formula-class.html">
<link rel="import" href="../data/tablet-class.html">
<link rel="import" href="../data/batch-class.html">

<script>
  
    // create an initial state 
    const initialState = {
        isAdmin: false,
        pan: new CoatingPan().toJSON(),      /*global CoatingPan*/
        tablet: new Tablet().toJSON(),       /*global Tablet*/
        batch: new Batch(),                 /*global Batch*/
        coatingFormula: new CoatingFormula()
    };
    
    
    const storedState = JSON.parse(sessionStorage.getItem('coating-toolbox-state'));
    
    let startState = storedState || initialState;
    startState = initialState;
    
    // create a reducer for actions
    const reducer = (state = startState, action) => {
        let newState = Object.assign({}, state);
        switch(action.type) {
            case "SET_ADMIN":
                newState.isAdmin = action.value;
                break;
            case "LOAD_TABLET":
                newState.tablet = action.value;
                break;
            case "LOAD_PAN":
                newState.pan = action.value;
                break;
            case "LOAD_COATING_FORMULA":
                newState.coatingFormula = action.value;
                break;
        }
        sessionStorage.setItem('coating-toolbox-state', JSON.stringify(newState));
        return newState;
    };
    
    // create the redux store
    /* global Redux */
    const store = Redux.createStore(reducer);
    
    // pass the redux store to the PolymerRedux to create a mixing which is used with other polymer elements
    /* global PolymerRedux*/
    const ReduxMixin = PolymerRedux(store);
    
</script>

